---
title: 文本批处理
class: heading_no_counter
keywords: 文本, 批处理, 模板, 公式 
desc: 按照模板对表格中的文本进行批处理，内置各种公式
---

## 介绍

可以对表格中的文本按行进行批处理，可以自定义模板，内置数十种函数，支持各种运算

![](../../assets/images/ToolsSet/TSTBatch.png)

## 使用方法

在左侧表格中输入待处理文本，中间区域可以定义运算表达式和模板，点击右侧区域的【Generte】即可生成处理结果，可以点击复制按钮复制结果文本

* 输入区域为200行x50列，可以点击上方按钮添加行，点击一次可添加100行
* 输入区域可以直接粘贴用制表符（Tab键）分隔的文本，会自动以制表符分列填充
* 跳过滑动条可以设置跳过前面的指定行数，如果开启转置则表示跳过指定列数
* 转置开关可以切换循环方向为行或列，默认为关闭表示按行循环，打开后将交换行列，进行按列循环
* 选区开关打开后可以仅对选择区域进行循环，否则会对所有数据区进行循环操作

### 表达式和模板说明

1. 最终结果根据模板生成，表达式可在模板中使用
2. 表达式可以使用内置函数，表达式定义时每行输入一个，使用时通过 *\$Exp+行号* 在模板中使用，比如 *\$Exp1* 代表第一个表达式
3. 模板中不能直接使用内置函数，只能通过表达式来使用
4. *\$+列号* 代表一个单元格的内容，在表达式和模板中都可以使用，列号从 **1** 开始。比如 *\$1* 默认代表每行第一列单元格的内容。
   > ***\$0*** 表示当前的行号，如果转置开启则表示当前列号
   > 
   > 如果转置开关打开，将转为按列循环，\$后的数字将表示行号
   >
   > 如果选区开关打开，*\$1* 表示选择区域的第一行或第一列（转置开关打开时）
5. 光标处于表达式文本框中时，右侧添加函数按钮可用，可以点击此按钮查看内置函数，鼠标悬停在函数上可用查看函数说明，鼠标单击函数即可将其插入到光标处
   > 函数名称不区分大小写
   >
   > 函数中如果有错误，转换结果将会显示：[Exp Error]
6. 光标处于模板文本框中时，右侧添加表达式按钮和模板片段按钮可用，可以点击按钮后选择表达式或模板片段插入光标处
   > 表达式菜单的第一个函数为“$Cell(row, col)”，此函数在转换时将被替换为参数指定行列单元格的内容，可用于输出固定值，如果行列值错误，转换结果将会显示：[Cell Error]
   >
   > 模板片段插入默认文本后可以修改，点击【Generte】会使用最新的模板生成内容，可以点击文本框右上角的【x】快速清除模板内容
   >
   > 模板中无法识别转换的字符串在生成时都作为字面值之间输出

7. 执行生成时会对左侧表格中的每行进行模板替换，并会自动运算模板中的函数。比如使用上图中的输入即可快速生成 C# 实体类中的属性定义代码